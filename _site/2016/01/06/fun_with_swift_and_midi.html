<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Joe Armstrong" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title>Fun with Swift and Midi</title>
    
    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen" />
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />
    <link rel="stylesheet" href="/css/screen.css" type="text/css" 
	  media="screen, projection" />
  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
	<a class="brand" href="/index.html">Joe Armstrong - Erlang and other stuff</a>
	<ul class="nav">
	  <li><a href="/index.html">Home</a></li>
	  <li><a href="/archive.html">Archive</a></li>
	  <li><a href="/resources.html">Resources</a></li>
	  <li><a href="/installing.html">Installing</a></li>
	  <li><a href="/links.html">Links</a></li>
	  <li><a href="https://github.com/joearms/joearms.github.com/">Source</a></li>
	</ul>
      </div>
    </div>
    
    <div class="customize">
      <div class="row-fluid">
	<div class="span7 offset1">
	  <div>
  <div id="title">
  
    <h1>Fun with Swift and Midi</h1>
    <span class="meta">06 Jan 2016</span>
    <p></p>
  </div>

  <div id="content">
    <p>Seems like I can control core audio directly from the command line in Swift.
no horrid Xcode is involved.</p>

<blockquote>
  <p>One quick example seems to be worth a thousand words, so here’s a
version of <code class="highlighter-rouge">PlaySoftMidi.cpp</code> converted to Swift.</p>
</blockquote>

<p><em>PlaySoftMidi</em> has
been in the Mac Developer library since 2007 and is just about the
only program I can understand that <em>uses</em> the CoreAudio stuff.</p>

<p>If you have swift2.1 on your machine save <code class="highlighter-rouge">PlaySoftMidi.swift</code> in a file and
give the command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>swift PlaySoftMidi.swift
</code></pre>
</div>

<p>And the program will play samples from the inbuilt synthesizer.</p>

<p>Here are the programs:</p>

<ul>
  <li><a href="https://developer.apple.com/library/mac/samplecode/PlaySoftMIDI/Listings/main_cpp.html">PLaySoftMidi.cpp</a> – Apple origonal program</li>
  <li><a href="https://github.com/joearms/joearms.github.com/tree/master/_posts/swift/PlaySoftMidi.swift">PlaySoftMidi.swift</a> – The above converted to Swift and modified</li>
</ul>

<p>These two program also show the equivalence between <code class="highlighter-rouge">C++</code> and <code class="highlighter-rouge">Swift</code></p>

<h1 id="the-bad">The Bad</h1>

<p>For example in C++ we say:</p>

<pre>
enum {
    kMidiMessage_ControlChange      = 0xB,
    kMidiMessage_ProgramChange      = 0xC,
    kMidiMessage_BankMSBControl     = 0,
    kMidiMessage_BankLSBControl     = 32,
    kMidiMessage_NoteOn             = 0x9
};
</pre>

<p>And to use a constant just refer to it by name.</p>

<p>And In Swift we say:</p>

<pre>
enum Midi : UInt32 {
    case kMidiMessage_ControlChange = 0xB
    case kMidiMessage_ProgramChange = 0xC
    case kMidiMessage_BankMSBControl = 0
    case kMidiMessage_BankLSBControl = 32
    case kMidiMessage_NoteOn = 0x9
    case kMidiMessageProgramChange = 0xC0
}
</pre>

<p>And to use a value say something like: <code class="highlighter-rouge">Midi.kMidiMessageProgramChange.rawValue</code></p>

<p>I hope this is not a trend - just when you though programming language
couldn’t get any more verbose, they did.</p>

<h1 id="the-good">The Good</h1>

<p>Type casts seem to be functions. If <code class="highlighter-rouge">x</code> in Swift is an <code class="highlighter-rouge">Int</code> and I
want to convert it to a variable <code class="highlighter-rouge">y</code> of type <code class="highlighter-rouge">UInt32</code> I say:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>y = UInt32(x)
</code></pre>
</div>

<p>And NOT <code class="highlighter-rouge">y = (UInt32) x</code> – <em>horay</em> say I.</p>

<h1 id="next-steps">Next Steps</h1>

<p>When I’ve got a socket interface working I’ll connect this to Erlang so that I can
hit the midi interface from Erlang – then the fun can begin.</p>


  </div>

  <div id="tags">
    Tagged:
    
    <a href="/blog/tag/swift">swift</a> &nbsp;
    
    <a href="/blog/tag/midi">midi</a> &nbsp;
    
    <a href="/blog/tag/synth">synth</a> &nbsp;
    
  </div>
  <p></p>

  <hr />
  
  <!-- the tweet button -->
  <p>
    <a href="https://twitter.com/share"  class="twitter-share-button" 
       data-url="http://joearms.github.com/2016/01/06/fun_with_swift_and_midi.html">Tweet</a>
  </p>
  
  <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
  <!-- end of tweet button -->

  <p>Comments:</p>
  
  <div id="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      // var disqus_developer = 1;
      var disqus_shortname = 'joearmstrongsblog';
      var disqus_identifier = '/2016/01/06/fun_with_swift_and_midi';
      var disqus_url = 'http://joearms.github.com/2016/01/06/fun_with_swift_and_midi.html';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </div>
  
  <noscript>
    Please enable JavaScript to view the <a
    href="http://disqus.com/?ref_noscript">comments powered by
    Disqus.</a>
  </noscript>
</div>

	</div>
	<div class="span3">
	  
	</div>
      </div>
    </div>
    
    <!-- Footer  ==================================== -->
    <footer class="footer">
      <div class="container">
	<p>&copy; 2013 Joe Armstrong</p>
	  Theme and code from <a href="https://github.com/mojombo">Tom
	  Preston-Werner</a>.<br /> Hosted by <a
	  href="https://github.com/networc/networc.github.com/">GitHub</a>
	  and powered by <a
	  href="https://github.com/mojombo/jekyll">Jekyll</a>.
	  Source code <a href="https://github.com/joearms/joearms.github.com">here</a>.
	</p>
	<p>
	  joearms@gmail.com <a href="http://github.com/joearms/">github.com/joearms</a>
	  <a href="http://twitter.com/joeerl/">twitter.com/joeerl</a>
	</p>
      </div>
    </footer>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-39670657-1', 'github.com');
      ga('send', 'pageview');
    </script>
    <!-- Google Analytics end -->
    
  </body>
</html>
