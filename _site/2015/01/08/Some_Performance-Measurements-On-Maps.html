<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Joe Armstrong" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title>Some Performance Measurements On Maps</title>
    
    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen" />
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />
    <link rel="stylesheet" href="/css/screen.css" type="text/css" 
	  media="screen, projection" />
  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
	<a class="brand" href="/index.html">Joe Armstrong - Erlang and other stuff</a>
	<ul class="nav">
	  <li><a href="/index.html">Home</a></li>
	  <li><a href="/archive.html">Archive</a></li>
	  <li><a href="/resources.html">Resources</a></li>
	  <li><a href="/installing.html">Installing</a></li>
	  <li><a href="/links.html">Links</a></li>
	  <li><a href="https://github.com/joearms/joearms.github.com/">Source</a></li>
	</ul>
      </div>
    </div>
    
    <div class="customize">
      <div class="row-fluid">
	<div class="span7 offset1">
	  <div>
  <div id="title">
  
    <h1>Some Performance Measurements On Maps</h1>
    <span class="meta">08 Jan 2015</span>
    <p></p>
  </div>

  <div id="content">
    <p>On Jan 8 Harit Hamnshu asked <a href="http://erlang.org/pipermail/erlang-questions/2015-January/082455.html">this question</a>
on the erlang mailing list.</p>

<p>To quote from the mail:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Write a function map_search_pred(Map, Pred) that returns the first element
{Key,Value} in the map for which Pred(Key, Value) is true.

My attempt, looks like

map_search_pred(Map, Pred)  -&gt;
  M = [{Key, Value} || {Key, Value} &lt;- maps:to_list(Map),
                                       Pred(Key, Value) =:= true],
  case length(M) of
    0 -&gt; {};
    _ -&gt; lists:nth(1, M)
  end.
</code></pre>
</div>

<p>I thought <em>That’s an interesting question</em> and secondly <em>the answer
is obvious, just iterate over the map and terminate when the predicate
is satisfied</em>. But it turns out that this is impossible.</p>

<blockquote>
  <p>I thought I’d write a little program to test if my intuition was
correct. Here’s what happened:</p>
</blockquote>

<h1 id="thought-1-its-easy">Thought 1: It’s easy</h1>

<p>This was my first thought. This is <em>always</em> my first thought <em>I’m an optimist</em>.
I also wonder why the heck does anybody worry about performance.</p>

<blockquote>
  <p>I was
brought up in the days of MHz clocks so back in the day I did worry about this
but when GHz clocks came I stopped worrying.</p>
</blockquote>

<h1 id="thought-2-i-have-to-measure-this">Thought 2: I have to <em>measure</em> this.</h1>

<p>I know my intuition about performance is always wrong - so it’s
<em>measure, measure, measure</em>.</p>

<p>At this stage I wrote some code to make a large map:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>make(0, M, _) -&gt; M;
make(K, M, I) -&gt; make(K-1,maps:put(I,I+1,M),I+2).
</code></pre>
</div>

<p>Call this with <code class="highlighter-rouge">make(1000,#{},1)</code> and I get a map with 1000 elements.</p>

<p>Then I added an element at the <code class="highlighter-rouge">beginning'' and</code>end’’ of then map
and made a few measurements.</p>

<blockquote>
  <p>and yes I know that there is no much thing as the <strong>begining</strong>
and <strong>end</strong> of a map. So ``beginning’’ means  <em>at that position
in the map that I expect to be visted first when I traverse the map.</em></p>
</blockquote>

<p>Then I wrote some code to generate a list and measure
the times to locate an element when it was at the beginning and end of
the map. Something like this:</p>

<p><code class="highlighter-rouge">
test(K) -&gt;
    Map = make(K, #{}, 1),
    Map1 = Map#{0 =&gt; 0},
    Map2 = Map#{123456789 =&gt; 123456789},
    List1 = maps:to_list(Map1),
    List2 = maps:to_list(Map2),
    J1 = timer:tc(?MODULE, map_search_pred,[Map1,fun(X,Y) -&gt; X =:= Y end]),
    J2 = timer:tc(?MODULE, map_search_pred,[Map2,fun(X,Y) -&gt; X =:= Y end]),
    ...
</code></p>

<p>I’d expected the timer results <code class="highlighter-rouge">J1</code> and <code class="highlighter-rouge">J2</code> to be the same but
there weren’t. Since the entire list gets traversed in both cases, the
times should be roughly the same. But they weren’t.</p>

<p><strong>I’ve append the entire program at the end of this posting.</strong></p>

<blockquote>
  <p>The results of this first test puzzled me at first. But hang on, I
 know that a)
<strong>performance measurement is difficult</strong> b) <strong>My intuition
 about performance is always wrong</strong>.</p>
</blockquote>

<p>My use of <code class="highlighter-rouge">timer:tc</code> just gives me a ``quick first idea’’ as to what’s going on.</p>

<p>What’s really going on is complicated by the garbage collection and ``warming’’ the
  cache.</p>

<p>For fun I just swapped the order of the statements <code class="highlighter-rouge">J1 = ...</code> and <code class="highlighter-rouge">J2 =
...</code> in the program and re-ran it. This shouldn’t change anything. The
<em>semantics</em> of the program are unchanged by this reordering - <em>but</em>
the timings change  a lot.</p>

<p>As I said - ``<strong>performance measurement is difficult</strong>’’</p>

<h1 id="thought-3">Thought 3:</h1>

<p>The ``obvious’’ way to terminate abruptly from a loop
  is to use <code class="highlighter-rouge">catch/throw</code> (<em>that’s why we have <code class="highlighter-rouge">catch/throw</code></em>).</p>

<p>I defined:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>J3 = timer:tc(?MODULE, map_search_pred1,
              [Map2, 
       	   fun(X, Y) when X =:= Y -&gt; throw({X,Y});
	      (_,_) -&gt; false
	   end]),
</code></pre>
</div>

<p>And:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>map_search_pred1(A, B) -&gt;
  (catch map_search_pred(A,B)).
</code></pre>
</div>

<p>This still converts the entire map to a list, but exits early from the
list comprehension.</p>

<p>And yes it was faster ``most of the time’’ - ie in several runs it <em>was</em>
   faster but sometimes it was slower:</p>

<p>Here’s a typical run with a 20,000 element map:</p>

<p><code class="highlighter-rouge"><span class="w">
 </span><span class="p">{</span><span class="err">length,20000</span><span class="p">}</span><span class="err">,</span><span class="w">
 </span><span class="p">{</span><span class="err">maps_at_start,{6479,{0,0</span><span class="p">}</span><span class="err">}},</span><span class="w">
 </span><span class="p">{</span><span class="err">maps_at_end,{2327,{123456789,123456789</span><span class="p">}</span><span class="err">}},</span><span class="w">   </span><span class="err">&lt;-</span><span class="w"> </span><span class="mi">1</span><span class="err">)</span><span class="w"> </span><span class="err">should</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">same</span><span class="w"> </span><span class="err">maps_at_start</span><span class="w">
 </span><span class="p">{</span><span class="err">maps_thrown,{1814,{123456789,123456789</span><span class="p">}</span><span class="err">}},</span><span class="w">   </span><span class="err">&lt;-</span><span class="w"> </span><span class="mi">2</span><span class="err">)</span><span class="w"> </span><span class="err">it</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">faster</span><span class="w">
 </span><span class="p">{</span><span class="err">maps_foldl,{2486,{123456789,123456789</span><span class="p">}</span><span class="err">}},</span><span class="w">
 </span><span class="p">{</span><span class="err">lists_start,{2,{0,0</span><span class="p">}</span><span class="err">}},</span><span class="w">
 </span><span class="p">{</span><span class="err">lists_end,{1221,{123456789,123456789</span><span class="p">}</span><span class="err">}}}</span><span class="w">
</span></code></p>

<p>This shows the name of the test and the result of calling <code class="highlighter-rouge">timer:tc</code> on the test case.</p>

<p>So now I have a program that works and I can make measurements with.</p>

<h1 id="thought-4">Thought 4:</h1>

<blockquote>
  <p>The notion of ``order’’ in a map is unclear. I know that maps are
printed in lexical order, but I don’t know if they are stored
internally in the same order as which they are printed.<br />
And they might perform differently if the maps have
a small or large number of elements.</p>
</blockquote>

<h1 id="thought-5">Thought 5:</h1>

<p>The notion of iterating over the elements of a map seems strange to
me. I always think of lists as being ``things that you iterate over’’
especially when there are large numbers of things.</p>

<p>Probably I’m being old-fashioned here. I guess I should think of
iterating over collections, but to me a collection is just a fancy
name for a list.</p>

<blockquote>
  <p>and lists in Erlang aren’t even <code class="highlighter-rouge">lists</code>. They are really  <code class="highlighter-rouge">stacks</code> -
but that’s another story, and changing the name would not be a good
idea.</p>
</blockquote>

<h1 id="thought-6">Thought 6:</h1>

<p>For short maps measuring the time is pointless - access times will be
very fast and it will be difficult to measure the differences in time
for different implementations. And for large collections I should be
using lists anyway.</p>

<h1 id="thought-7">Thought 7:</h1>

<blockquote>
  <p>There <strong>should be</strong> a maps iterator.</p>
</blockquote>

<p>Why don’t I just walk over the map element at a
time until I get what I want. I need a <code class="highlighter-rouge">first</code>, and <code class="highlighter-rouge">next</code> operator
defined over a map.</p>

<p>I consult the manual page for <code class="highlighter-rouge">maps.erl</code>, looking for <code class="highlighter-rouge">first</code> and <code class="highlighter-rouge">next</code>.</p>

<h1 id="thought-8">Thought 8:</h1>

<p>The only maps iterator I can find is <code class="highlighter-rouge">maps:fold</code>.</p>

<p>I should be able to ``throw my way out’’ of <code class="highlighter-rouge">maps:fold</code>.</p>

<p>Then I read the code:</p>

<p><code class="highlighter-rouge">maps:fold</code> is defined like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> fold(Fun, In it, Map) when is_function(Fun,3), is_map(Map) -&gt;
    lists:fold(fun({K,V},A) -&gt; Fun(K,V,A) end,In it,maps:to_list(Map)).
</code></pre>
</div>

<p>So the map is converted to a list anyway, <strong>this is horrific</strong>.</p>

<blockquote>
  <p>All of which means there is no alternative to converting the
map to list first and then walking down the list to get what you want.</p>
</blockquote>

<p>Finding the first element in a list that satisfies a predicate is
really easy:</p>

<p><code class="highlighter-rouge">
find_first([H|T], Pred) -&gt;
   case Pred(H) of
      true  -&gt; H;
      false -&gt; find_first(T, Pred)
   end;
find_first([], _) -&gt;
   {}.
</code></p>

<p>My intuition says this will be fastest:</p>

<p>I measure:</p>

<p><code class="highlighter-rouge">
&gt; p1:test(20000).
 {length,20000},
 {maps_at_start,{6215,{0,0}}},
 {maps_at_end,{2253,{123456789,123456789}}},
 {maps_thrown,{1827,{123456789,123456789}}},
 {maps_fold,{2698,{123456789,123456789}}},
 {lists_start,{3,{0,0}}},
 {lists_end,{1229,{123456789,123456789}}}}
</code></p>

<p>** This time I was right**. When the element is at the start of the
list it’s very quick. When the element is at the end of the list it’s
faster than all the implementations using maps.  Also it makes sence
to talk about an element being <code class="highlighter-rouge">at the start of a list' or</code>at the
end.’’</p>

<p>I’ve appended my test program. As I said earlier, swapping the lines <code class="highlighter-rouge">J1=...</code>
and <code class="highlighter-rouge">J2=...</code> and running the program will convince you that performance
estimation is tricky.</p>

<blockquote>
  <p>actually micro benchmarks (like this) are pretty difficult to interpret.
at the end of the day you have to ask ``is my application fast enough.’’
Most projects fail before the applications are complete so this question
never gets answered]</p>
</blockquote>

<h1 id="heres-the-test-program">Here’s the test program</h1>

<figure class="highlight"><pre><code class="language-erlang" data-lang="erlang"><span class="p">-</span><span class="ni">module</span><span class="p">(</span><span class="n">maps_timings</span><span class="p">).</span>
<span class="p">-</span><span class="ni">compile</span><span class="p">(</span><span class="n">export_all</span><span class="p">).</span>

<span class="nf">map_search_pred</span><span class="p">(</span><span class="nv">Map</span><span class="p">,</span> <span class="nv">Pred</span><span class="p">)</span>  <span class="o">-&gt;</span>
    <span class="nv">M</span> <span class="o">=</span> <span class="p">[{</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}</span> <span class="p">||</span> <span class="p">{</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">}</span> <span class="o">&lt;-</span> <span class="nn">maps</span><span class="p">:</span><span class="nf">to_list</span><span class="p">(</span><span class="nv">Map</span><span class="p">),</span> <span class="nv">Pred</span><span class="p">(</span><span class="nv">Key</span><span class="p">,</span> <span class="nv">Value</span><span class="p">)</span> <span class="o">=:=</span> <span class="n">true</span><span class="p">],</span>
    <span class="k">case</span> <span class="nb">length</span><span class="p">(</span><span class="nv">M</span><span class="p">)</span> <span class="k">of</span>
	<span class="mi">0</span> <span class="o">-&gt;</span> <span class="p">{};</span>
	<span class="p">_</span> <span class="o">-&gt;</span> <span class="nn">lists</span><span class="p">:</span><span class="nf">nth</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">M</span><span class="p">)</span>
    <span class="k">end</span><span class="p">.</span>

<span class="nf">map_search_pred1</span><span class="p">(</span><span class="nv">A</span><span class="p">,</span> <span class="nv">B</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="p">(</span><span class="k">catch</span> <span class="nf">map_search_pred</span><span class="p">(</span><span class="nv">A</span><span class="p">,</span><span class="nv">B</span><span class="p">)).</span>

<span class="nf">test</span><span class="p">(</span><span class="nv">K</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="nv">Map</span> <span class="o">=</span> <span class="nf">make</span><span class="p">(</span><span class="nv">K</span><span class="p">,</span> <span class="err">#</span><span class="p">{},</span> <span class="mi">1</span><span class="p">),</span>
    <span class="nv">Map1</span> <span class="o">=</span> <span class="nv">Map</span><span class="err">#</span><span class="p">{</span><span class="mi">0</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">},</span>
    <span class="nv">Map2</span> <span class="o">=</span> <span class="nv">Map</span><span class="err">#</span><span class="p">{</span><span class="mi">123456789</span> <span class="o">=&gt;</span> <span class="mi">123456789</span><span class="p">},</span>
    <span class="nv">List1</span> <span class="o">=</span> <span class="nn">maps</span><span class="p">:</span><span class="nf">to_list</span><span class="p">(</span><span class="nv">Map1</span><span class="p">),</span>
    <span class="nv">List2</span> <span class="o">=</span> <span class="nn">maps</span><span class="p">:</span><span class="nf">to_list</span><span class="p">(</span><span class="nv">Map2</span><span class="p">),</span>
    <span class="nv">J1</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">map_search_pred</span><span class="p">,[</span><span class="nv">Map1</span><span class="p">,</span><span class="k">fun</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span><span class="nv">Y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="k">end</span><span class="p">]),</span>
    <span class="nv">J2</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">map_search_pred</span><span class="p">,[</span><span class="nv">Map2</span><span class="p">,</span><span class="k">fun</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span><span class="nv">Y</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="k">end</span><span class="p">]),</span>
    <span class="nv">J3</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">map_search_pred1</span><span class="p">,</span> <span class="p">[</span><span class="nv">Map2</span><span class="p">,</span> 
					      <span class="k">fun</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span><span class="p">)</span> <span class="k">when</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="o">-&gt;</span> <span class="nf">throw</span><span class="p">({</span><span class="nv">X</span><span class="p">,</span><span class="nv">Y</span><span class="p">});</span>
						 <span class="p">(_,_)</span> <span class="o">-&gt;</span> <span class="n">false</span>
					      <span class="k">end</span><span class="p">]),</span>
    <span class="nv">J4</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">faster</span><span class="p">,</span> <span class="p">[</span><span class="nv">Map2</span><span class="p">,</span> 
				    <span class="k">fun</span><span class="p">(</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span><span class="p">,</span> <span class="p">_)</span> <span class="k">when</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="o">-&gt;</span> <span class="nf">throw</span><span class="p">({</span><span class="nv">X</span><span class="p">,</span><span class="nv">Y</span><span class="p">});</span>
				       <span class="p">(_,_,</span> <span class="nv">A</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nv">A</span>
				    <span class="k">end</span><span class="p">]),</span>
    <span class="nv">J5</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">find_first</span><span class="p">,</span> <span class="p">[</span><span class="nv">List1</span><span class="p">,</span> <span class="k">fun</span><span class="p">({</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="k">end</span><span class="p">]),</span>
    <span class="nv">J6</span> <span class="o">=</span> <span class="nn">timer</span><span class="p">:</span><span class="nf">tc</span><span class="p">(</span><span class="o">?</span><span class="nv">MODULE</span><span class="p">,</span> <span class="n">find_first</span><span class="p">,</span> <span class="p">[</span><span class="nv">List2</span><span class="p">,</span> <span class="k">fun</span><span class="p">({</span><span class="nv">X</span><span class="p">,</span> <span class="nv">Y</span><span class="p">})</span> <span class="o">-&gt;</span> <span class="nv">X</span> <span class="o">=:=</span> <span class="nv">Y</span> <span class="k">end</span><span class="p">]),</span>
    
    <span class="p">{</span>
     <span class="p">{</span><span class="nb">length</span><span class="p">,</span><span class="nv">K</span><span class="p">},</span>
     <span class="p">{</span><span class="n">maps_at_start</span><span class="p">,</span><span class="nv">J1</span><span class="p">},</span> 
     <span class="p">{</span><span class="n">maps_at_end</span><span class="p">,</span><span class="nv">J2</span><span class="p">},</span> <span class="p">{</span><span class="n">maps_thrown</span><span class="p">,</span><span class="nv">J3</span><span class="p">},</span> <span class="p">{</span><span class="n">maps_foldl</span><span class="p">,</span><span class="nv">J4</span><span class="p">},</span> 
     <span class="p">{</span><span class="n">lists_start</span><span class="p">,</span><span class="nv">J5</span><span class="p">},</span>
     <span class="p">{</span><span class="n">lists_end</span><span class="p">,</span><span class="nv">J6</span><span class="p">}}.</span>
     
<span class="nf">make</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nv">M</span><span class="p">,</span> <span class="p">_)</span> <span class="o">-&gt;</span> <span class="nv">M</span><span class="p">;</span>
<span class="nf">make</span><span class="p">(</span><span class="nv">K</span><span class="p">,</span> <span class="nv">M</span><span class="p">,</span> <span class="nv">I</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nf">make</span><span class="p">(</span><span class="nv">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nn">maps</span><span class="p">:</span><span class="nb">put</span><span class="p">(</span><span class="nv">I</span><span class="p">,</span><span class="nv">I</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nv">M</span><span class="p">),</span><span class="nv">I</span><span class="o">+</span><span class="mi">2</span><span class="p">).</span>

<span class="nf">faster</span><span class="p">(</span><span class="nv">Map</span><span class="p">,</span> <span class="nv">Fun</span><span class="p">)</span> <span class="o">-&gt;</span> 
    <span class="k">case</span> <span class="k">catch</span> <span class="p">(</span><span class="nn">maps</span><span class="p">:</span><span class="nf">fold</span><span class="p">(</span><span class="nv">Fun</span><span class="p">,</span> <span class="p">[],</span> <span class="nv">Map</span><span class="p">))</span> <span class="k">of</span>
	<span class="p">[]</span> <span class="o">-&gt;</span> <span class="p">{};</span>
	<span class="nv">Other</span> <span class="o">-&gt;</span> <span class="nv">Other</span>
    <span class="k">end</span><span class="p">.</span>

<span class="nf">find_first</span><span class="p">([</span><span class="nv">H</span><span class="p">|</span><span class="nv">T</span><span class="p">],</span> <span class="nv">Pred</span><span class="p">)</span> <span class="o">-&gt;</span>
    <span class="k">case</span> <span class="nv">Pred</span><span class="p">(</span><span class="nv">H</span><span class="p">)</span> <span class="k">of</span>
	<span class="n">true</span>  <span class="o">-&gt;</span> <span class="nv">H</span><span class="p">;</span>
	<span class="n">false</span> <span class="o">-&gt;</span> <span class="nf">find_first</span><span class="p">(</span><span class="nv">T</span><span class="p">,</span> <span class="nv">Pred</span><span class="p">)</span>
    <span class="k">end</span><span class="p">;</span>
<span class="nf">find_first</span><span class="p">([],</span> <span class="p">_)</span> <span class="o">-&gt;</span>
    <span class="p">{}.</span></code></pre></figure>


  </div>

  <div id="tags">
    Tagged:
    
    <a href="/blog/tag/erlang">erlang</a> &nbsp;
    
    <a href="/blog/tag/maps">maps</a> &nbsp;
    
    <a href="/blog/tag/performance">performance</a> &nbsp;
    
  </div>
  <p></p>

  <hr />
  
  <!-- the tweet button -->
  <p>
    <a href="https://twitter.com/share"  class="twitter-share-button" 
       data-url="http://joearms.github.com/2015/01/08/Some_Performance-Measurements-On-Maps.html">Tweet</a>
  </p>
  
  <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
  <!-- end of tweet button -->

  <p>Comments:</p>
  
  <div id="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      // var disqus_developer = 1;
      var disqus_shortname = 'joearmstrongsblog';
      var disqus_identifier = '/2015/01/08/Some_Performance-Measurements-On-Maps';
      var disqus_url = 'http://joearms.github.com/2015/01/08/Some_Performance-Measurements-On-Maps.html';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </div>
  
  <noscript>
    Please enable JavaScript to view the <a
    href="http://disqus.com/?ref_noscript">comments powered by
    Disqus.</a>
  </noscript>
</div>

	</div>
	<div class="span3">
	  
	</div>
      </div>
    </div>
    
    <!-- Footer  ==================================== -->
    <footer class="footer">
      <div class="container">
	<p>&copy; 2013 Joe Armstrong</p>
	  Theme and code from <a href="https://github.com/mojombo">Tom
	  Preston-Werner</a>.<br /> Hosted by <a
	  href="https://github.com/networc/networc.github.com/">GitHub</a>
	  and powered by <a
	  href="https://github.com/mojombo/jekyll">Jekyll</a>.
	  Source code <a href="https://github.com/joearms/joearms.github.com">here</a>.
	</p>
	<p>
	  joearms@gmail.com <a href="http://github.com/joearms/">github.com/joearms</a>
	  <a href="http://twitter.com/joeerl/">twitter.com/joeerl</a>
	</p>
      </div>
    </footer>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-39670657-1', 'github.com');
      ga('send', 'pageview');
    </script>
    <!-- Google Analytics end -->
    
  </body>
</html>
