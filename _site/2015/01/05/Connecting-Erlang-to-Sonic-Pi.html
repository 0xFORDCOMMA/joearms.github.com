<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Joe Armstrong" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title>Connecting Erlang to the Sonic Pi</title>
    
    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" media="screen" />
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />
    <link rel="stylesheet" href="/css/screen.css" type="text/css" 
	  media="screen, projection" />
  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
	<a class="brand" href="/index.html">Joe Armstrong - Erlang and other stuff</a>
	<ul class="nav">
	  <li><a href="/index.html">Home</a></li>
	  <li><a href="/archive.html">Archive</a></li>
	  <li><a href="/resources.html">Resources</a></li>
	  <li><a href="/installing.html">Installing</a></li>
	  <li><a href="/links.html">Links</a></li>
	  <li><a href="https://github.com/joearms/joearms.github.com/">Source</a></li>
	</ul>
      </div>
    </div>
    
    <div class="customize">
      <div class="row-fluid">
	<div class="span7 offset1">
	  <div>
  <div id="title">
  
    <h1>Connecting Erlang to the Sonic Pi</h1>
    <span class="meta">05 Jan 2015</span>
    <p></p>
  </div>

  <div id="content">
    <p>Last September after giving <a href="https://www.youtube.com/watch?v=lKXe3HUG2l4">my keynote at
StrangeLoop</a> I bumped
into my old friend <a href="https://twitter.com/@samaaron">Sam Aaron</a>. As
usual he was bubbling over with enthusiasm, he’d been making a music
program for kids <a href="http://sonic-pi.net/">Sonic Pi</a> which interested me.</p>

<p>I’m interested in all things musical and especially making noises with computers
so I was <em>very</em> interested in Sonic Pi.</p>

<p>My first thought was ``how can I control Sonic Pi from Erlang?’’ – with
Sam at hand this turned out to be really really easy.</p>

<p><code class="highlighter-rouge">All you have to do,'' said Sam</code>is open UDP port 4557 and send it
an OSC message.’’</p>

<p>``What message?’’ I asked.</p>

<p><code class="highlighter-rouge">"\run code $string"</code> said Sam. Where <code class="highlighter-rouge">$string</code> is whatever you would
have typed into the Sonic Pi control window.</p>

<p>``That’s easy,’’ I thought, and it was. All I needed was a library to
convert Erlang terms to OSC messages. After a little searching I found
a library at <a href="https://github.com/mujaheed/erlang-osc">erlang-osc</a>.</p>

<p>The rest was easy.</p>

<p>I’d completely forgotten about this until earlier today when
<a href="https://twitter.com/@WadeMealing">@WadeMeadling</a>
tweeted me asking if the code was documented anywhere. Well it wasn’t and now it is.</p>

<p>I’ve put the code up at <a href="https://github.com/joearms/sonic_pi_interface">sonic_pi_inteface</a>
it’s been tested with sonic Pi version 2.0 and seems to work.</p>

<h1 id="on-the-sonic-pi-interface">On the Sonic Pi Interface</h1>

<p>I’d now like to take a moment and heap praises upon the design of
Sonic Pi. It literally took me about ten minutes to interface Erlang to Sonic Pi.</p>

<p><em>Actually this is not quite true</em> It took me ten minutes after Sam had explained how the
interface worked - he had not documented the interface, assuming that nobody would
wish to remotely control the program.</p>

<p>The interface is simplicity itself. Open a UDP port (in this case port
4557) and send it a fragment of Ruby (as an OSC message). Would that
all programs were that easy to interface.</p>

<p>I have had the misfortune to interface Erlang to the Apple Core-audio and Core-midi
interfaces - now this (interfacing to Core-audio) is not for the faint hearted.</p>

<p>Applications using core audio must be liked in memory to the core audio framework,
a practice which is bizarre and which makes interfacing to languages that do not
have the memory layout conventions of objective-C a pain.</p>

<p>This (the interfacing) harks back to the old arguments of <code class="highlighter-rouge">shared
memory'' verses</code>message passing’’ concurrency. Linking things in
memory and using callbacks is painfully difficult and highly error
prone.</p>

<p>This practise (shared memory) comes from the days when efficiency <em>was</em> a problem,
when we had computers with MHz clocks and tens of KBytes of memory. Those days
are long gone.</p>

<p>Using a message passing, interfacing to Sonic Pi was pure joy. Open a
port, send it a message, done.  Easy.</p>

<p>If I were defining an audio API I’d be able to say:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>piano ! {play_note, C}
</code></pre>
</div>

<p>From my favorite programming language (Erlang) and it would just work.</p>


  </div>

  <div id="tags">
    Tagged:
    
    <a href="/blog/tag/erlang">erlang</a> &nbsp;
    
    <a href="/blog/tag/sonic">sonic</a> &nbsp;
    
    <a href="/blog/tag/pi">pi</a> &nbsp;
    
  </div>
  <p></p>

  <hr />
  
  <!-- the tweet button -->
  <p>
    <a href="https://twitter.com/share"  class="twitter-share-button" 
       data-url="http://joearms.github.com/2015/01/05/Connecting-Erlang-to-Sonic-Pi.html">Tweet</a>
  </p>
  
  <script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
  <!-- end of tweet button -->

  <p>Comments:</p>
  
  <div id="disqus">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      // var disqus_developer = 1;
      var disqus_shortname = 'joearmstrongsblog';
      var disqus_identifier = '/2015/01/05/Connecting-Erlang-to-Sonic-Pi';
      var disqus_url = 'http://joearms.github.com/2015/01/05/Connecting-Erlang-to-Sonic-Pi.html';
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  </div>
  
  <noscript>
    Please enable JavaScript to view the <a
    href="http://disqus.com/?ref_noscript">comments powered by
    Disqus.</a>
  </noscript>
</div>

	</div>
	<div class="span3">
	  
	</div>
      </div>
    </div>
    
    <!-- Footer  ==================================== -->
    <footer class="footer">
      <div class="container">
	<p>&copy; 2013 Joe Armstrong</p>
	  Theme and code from <a href="https://github.com/mojombo">Tom
	  Preston-Werner</a>.<br /> Hosted by <a
	  href="https://github.com/networc/networc.github.com/">GitHub</a>
	  and powered by <a
	  href="https://github.com/mojombo/jekyll">Jekyll</a>.
	  Source code <a href="https://github.com/joearms/joearms.github.com">here</a>.
	</p>
	<p>
	  joearms@gmail.com <a href="http://github.com/joearms/">github.com/joearms</a>
	  <a href="http://twitter.com/joeerl/">twitter.com/joeerl</a>
	</p>
      </div>
    </footer>

    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      
      ga('create', 'UA-39670657-1', 'github.com');
      ga('send', 'pageview');
    </script>
    <!-- Google Analytics end -->
    
  </body>
</html>
